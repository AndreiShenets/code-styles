# Оглавление

* [Вводная](/ru/README.md)
* [Общие принципы](/ru/general-principles.md)
* [Рекомендации / примеры по стилю в C\#](/ru/c.md)
* [Рекомендации / примеры по стилю в Javascript style recommendations](/ru/javascript.md)
* [Рекомендации / примеры по стилю в SQL](/ru/sql.md)

# Основные принципы

1. Код должен быть хорошо читаемым => Читаемость
2. Код должен быть удобен для написания и изменения => Написание
3. Код должен хорошо выглядеть, нравиться => Внешний вид / Стиль

При написании кода стоит руководствоваться *правилами* выше. И, что очень важно!, именно в том порядке в котором они записаны. В первую очередь код должен быть читаемым. Обоснование крайне простое, по разным оценкам, которые могут от проекта к проекту варьироваться, программисты тратят где-то 70-80% времени на чтения кода. Добавьте к этому тот факт, что ваш код будут читать ваши коллеги, и им его читать будет сложнее. Добавьте к этому, что через неделю или две вы забудете что происходит у вас в коде и будете сами читать свой код.

**Вывод**: в первую очередь код должен быть читаемым.

Однако стоит помнить, что вы еще и пишете код, поэтому ваш стиль должен давать хорошо читаемым и быть чем проще тем лучше. Это даст возможность писать код быстрее и при этом соблюдать рекомендации. Если стоит выбор между написать немного больше, написать чуть менее удобно, но более читаемо, то стоит выбрать **написать менее удобно, но более читаемо**.
Однако стоит хорошо помнить, что код не только пишется в первый раз, но и поддерживается. Это значит, что при изменении вашего кода вы не должны тратить дополнительных усилий для приведения его в читаемый вид. В первую очередь это относится к выравниванию кода, которого стоит избегать в большинстве случаев (выравнивание будет рассмотрено подробнее позже).

**Вывод**: Код должно быть удобно писать и модифицировать, но читаемость всё же важнее.

При соблюдении первых двух пунктов вы можете менять свой стиль как вам *нравится*. Многие разработчики ставят этот пункт во главу списка. Я крайней не рекомендую так делать. Вместо это я настоятельно рекомендую, особенно если вы уполномоченное лицо на проекте, прописать для всех членов команды стиль, который вы будете использовать на проекте, дабы код был одинаковым. К этому я настоятельно рекомендую настроить проверку стиля автоматическими инструментами, например ReSharper для C# или eslint в JavaScript. Можно добавить инструменты для автоматического форматирования, если есть желание. Также можно настроить pre-commit hooks в вашей системе контроля версий для отсечения "плохих" коммитов. Однако оставьте возможность отменить автоформатирование, иногда определенное исключение действительно важно. Например если вы описываете одномерный массив как матрицу.

При соблюдении всех правил вы получите хорошо читаемый, легко модифицируемый код, который вам будет нравится визуально.
Вы и любой член вашей команды сможет легко прочитать код, пускай, возможно, и не понять его. Как говориться "Лучше хорошо читаемый код и плохая архитектура, чем наоборот".
Ваш производительность, а так же производительность вашей команды вырастет за счет автоматических инструментов и единого стиля.

# Читаемость

## Длина строки

Я **рекомендую ограничиться максимальную длину строки** кода **120** символами.

**Обоснование:**

В обосновании в первую очередь хочу рассказать о проблемах со слишком длинными строками. В первую очередь они ухудшают читаемость, т.е. нарушают основополагающее правило 1. Слишком длинная строка заставляет вас отвлекаться от чтения и понимания и переключаться на горизонтальную прокрутку, что крайней не удобно и затратно по времени. Кроме того если что-то скрыто за границей экрана, может быть потеряно из вида и не принято во внимание, что приведет к ошибкам в коде или другим проблемам. Например вы не заметили важные параметры функции или пропустили важное условие.

Отсюда следует вывод **слишком длинные строки - плохо**

Но какая же длина строки приемлемая? Давайте рассмотрим как обычному человеку удобно читать код и как можно делать это наиболее быстро и продуктивно. Согласно некоторым исследования, удобная полоса чтения для среднестатистического человека порядка 80-100 символов. Тут можно было бы сказать: "Давайте ограничим длину 100 символами", однако стоит принять во внимание, что на данный момент для работы используются широкоформатные мониторы, чаще всего FullHD (1920x1080), например у нас стандарт 22-24 дюйма, возможно там где вы работаете другой стандарт, опишу это ниже.
Самые частые операции с кодом, исходя из практики, следующие:
    - Чтение
    - Чтение на двух разных мониторах
    - Чтение на одном мониторе в редакторе с двумя панелями
    - Написание / Изменение
    - Написание / Изменение в редакторе с двумя панелями
    - Сравнение в инструменте с двумя панелями
    - Решение конфликтов при слиянии в инструменте с тремя панелями
    - Чтения запроса на слияние (Pull request) в инструменте или на сайте. Две панели.

Принимая во внимание, что вы или ваши коллеги могут использовать / используют две панели на одном мониторе для различных целей, стоит выбирать такую длину строки, которая позволит видеть всю строку кода код в обоих рядом стоящих панелях. Очень хорошо проверять данное правило на запросах на слияние на GitHub. Экспериментально выяснено, что в случае 120 символов:
1. Обычно всё влазит
2. Обычно всё влазит даже если у вашего коллеги плохое зрение и больше шрифт
3. Есть небольшой буфер если перенос строки не возможен или нецелесообразен.

Если у вас в команде размер мониторов и/или расширения выше, то вы определить другую длину строки и зафиксировать ее для всей команды.

Отсюда следует вывод **по умолчанию** оптимально использовать ограничение в **120** символов.

# Написание и как следствие читаемость

Написание это то, от чего сильно зависит читаемость. В первую очередь хочется продолжить тему про то, как обычно человек читает текст. В нашем случае мы рассматриваем чтение слева на право сверху вниз. Мозг человека построен так, что он оптимизирует производительность чтения. Для оптимизации у него есть отличные инструмент, который некоторыми учеными называется визуальное мышление (Visual Thinking). Суть его примерно следующая: когда наш мозг видит (через глаз естественно) что-то, что он часто обрабатывает, он пытается по внешнему виду (как будто по слепку или хэш значению) быстро получить сопоставленный результат (своеобразное кэш хранилище ключ-значение), если ассоциации нет или в процессе быстрой проверки что-то наш мозг насторожило, то задействуется логическое мышление (Logical Thinking), которое детально анализирует то, что написано и делает выводы.

Примеры такого поведения можно найти в интернете. Есть эксперимент, когда записывается какой-то цвет например <font color="blue">красный</font>, но цвет текста делается например <font color="red">синий</font>. В первую очередь отрабатывает визуальное мышление <font color="blue">красный</font> == синий, потом срабатывает "проверка" и задействуется логическое мышление <font color="blue">красный</font> == ~~синий~~ красный. Особенность данного поведения мозга в том, что визуальное мышление работает на порядки быстрее логического.

Отсюда можно сделать **вывод**: лучше писать код так, чтобы максимально задействовать визуальное мышление.

Как?

Мозг задействует в первую очередь визуальное мышление если:
1. Текст выделяется размером
2. Текст выделяется посредством близости к другому тексту
3. Текст выравнен

Для форматирования кода, как правило подходят пункты 2 и 3.

Пункт 2 это фактически группировка кода в маленькие логически связанные блоки. Блоки разделаются пустой строкой. Например:

```csharp
public ResultType ArbitraryMethodName(
    FirstArgumentType firstArgument,
    SecondArgumentType secondArgument,
    ThirdArgumentType thirdArgument)
{
    LocalVariableType localVariable = Method(
        firstArgument,
        secondArgument);

    if (localVariable.IsSomething(thirdArgument,
        SOME_SHOUTY_CONSTANT))
    {
        DoSomethingWith(localVariable);
    }

    return localVariable.GetSomething();
}
```

## Выравнивание (пункт 3)

Если коротко, то для выравнивания должны быть использованы только отступы. Клавиша Tab, которая трансформируется будь то в символ табуляции, 2, 4 или N пробелов. Я **настоятельно рекомендую** использовать пробелы, т.к. вы точно не будете иметь проблем с отступами, например, в случае с запросами на слияние.

**Обоснование:**

В первую очередь почему стоит использовать выравнивание - потому что задействуется визуальное мышление.
Почему только отступы. Как следует из правила 2 - код должен быть легко модифицируемым. Часто разработчики любят делать вот так:

```Java
int doNotFormat = likeThis(someArgumentOrExpression,
                           anotherArgumentOrExpression);
```

С одной стороны всё круто, задействовано визуальное мышление, с другой сломано удобство редактирования. Например, при переименовании функции выравнивание сломается.

**Вывод**: код должен быть устойчивым к изменениям. Намного лучше написать:

```Java
int insteadFormat =
    somethingLikeThis(
        someArgumentOrExpression,
        anotherArgumentOrExpression);


int orFormat = somethingLikeThis(
    someArgumentOrExpression,
    anotherArgumentOrExpression);


int orFormat = somethingLikeThis(
    someArgumentOrExpression,
    anotherArgumentOrExpression
);
```

Рекомендую самый последний вариант, так как он позволяет более четко отделить параметры, параметры проще добавлять, менять местами и так далее.

Почему плохо вот так:

```Java
int insteadFormat = somethingLikeThis(someArgumentOrExpression,
    anotherArgumentOrExpression);
```

Тут хорошее место чтобы упомянуть, что хорошо читаемый код во многом является хорошо читаемым из-за осмысленных имен функций, методов, переменных... Если того будет требовать читаемость, код может стать чем-то таким:

```Java
int longNameBecauseINeedItForBetterReadability = somethingLongNamedFunctionForBetterReadability(someArgumentOrExpression,
    anotherArgumentOrExpression);
```

В этом случае параметры разделены большим расстоянием, получилось так потому, что мы использовали переименование где-то в другом месте, а "плохо" стало тут - "отломано" визуальное мышление. Т.е. код не является устойчивым к изменениям.

# Краткие итоги

Что делаем:
- Считаем что Читаемость > Написание > Внешний вид
- Считаем что Визуальное мышление > Логическое мышление и используем:
    - Длина строки <= 120 (по умолчанию)
    - Логические блоки с помощью новой строки
    - Выравнивание отступами
    - "Устойчивый"" код

Что используем:
- Клавишу Enter для новой строки
- Клавишу Tab для отступа

Проще некуда!

Что получаем:
- Быстрое чтение сверху вниз с использованием только вертикальной прокрутки
- Осмысление только важных в данный момент вещей за счет быстрого визуального мышления
- Редактирование кода без дополнительных усилий
- Код выглядит хотя-бы хорошо и в одном стиле.
